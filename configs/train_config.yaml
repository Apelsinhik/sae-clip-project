# FILE: clip-sae-interpret_clean/configs/train_config.yaml
# ============================================
# CONFIG FOR TRAINING SAE ON CLIP ACTIVATIONS
# ============================================


# =====================================================
# STORAGE (ОБЯЗАТЕЛЬНО)
# =====================================================
# Используется train_sae.py + utils/storage.py
#
# ЛОГИКА:
# - читаем из Yandex, если доступен
# - иначе из Google
# - запись: Google (backup)
# =====================================================

storage:
  yandex_root: "/content/yadisk/SAE_PROJECT"
  google_root: "/content/drive/MyDrive/SAE_PROJECT"
  logs_dir: "/content/drive/MyDrive/SAE_PROJECT/logs"


# =====================================================
# DATA
# =====================================================
# Здесь мы НЕ извлекаем изображения.
# Мы работаем с УЖЕ СОХРАНЁННЫМИ CLIP-активациями.
# =====================================================

data:
  dataset: "cifar10"

  # Имя файла с активациями (storage.py сам добавит путь)
  activations_file: "activations_cifar10_vit_l14.pt"

  # Если activations не найдены — можно выбросить ошибку
  # (экстракцию мы делаем отдельным скриптом)
  extract_if_missing: false


# =====================================================
# SAE MODEL
# =====================================================
# input_dim  = размер CLIP embedding
# hidden_dim = размер словаря (кол-во латентов)
# =====================================================

model:
  input_dim: 768
  hidden_dim: 4096


# =====================================================
# TRAINING
# =====================================================
# Все гиперпараметры обучения SAE
# =====================================================

training:
  epochs: 50
  lr: 5e-4
  l1_coef: 1e-3

  # ⚡ ускоряем обучение
  batch_size: 256
  num_workers: 2
